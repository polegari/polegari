<!DOCTYPE html>
<html>
<head>
    <title>Gerar Excel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>Gerar Excel</h1>
    <form id="dataForm">
        <table id="dataTable">
            <thead>
                <tr>
                    <th>Código</th>
                    <th>Arroz P1</th>
                    <th>Arroz P2</th>
                    <th>Prazo</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                <!-- Linha inicial -->
                <tr>
                    <td><input type="text" name="codigo" /></td>
                    <td>
                        <select name="arrozP1">
                            <script>
                                for (let i = 0; i <= 100; i++) {
                                    document.write('<option value="' + i + '">' + i + '</option>');
                                }
                            </script>
                        </select>
                    </td>
                    <td>
                        <select name="arrozP2">
                            <script>
                                for (let i = 0; i <= 100; i++) {
                                    document.write('<option value="' + i + '">' + i + '</option>');
                                }
                            </script>
                        </select>
                    </td>
                    <td>
                        <select name="prazo">
                            <script>
                                for (let i = 1; i <= 45; i++) {
                                    document.write('<option value="' + i + ' dias">' + i + ' dias</option>');
                                }
                            </script>
                        </select>
                    </td>
                    <td><button type="button" onclick="removeRow(this)">Remover</button></td>
                </tr>
            </tbody>
        </table>
        <br>
        <button type="button" onclick="addRow()">Adicionar Linha</button>
        <button type="button" onclick="generateExcel()">Gerar Excel</button>
    </form>

    <h2>Resultados:</h2>
    <div id="results"></div>

    <script>
        function addRow() {
            var table = document.getElementById("dataTable").getElementsByTagName('tbody')[0];
            var row = table.insertRow();
            var cells = ['codigo', 'arrozP1', 'arrozP2', 'prazo'];
            cells.forEach(function(cell, i) {
                var newCell = row.insertCell(i);
                if (i === 1 || i === 2 || i === 3) {
                    var select = document.createElement("select");
                    for (let j = 0; j <= (i === 3 ? 45 : 100); j++) {
                        var option = document.createElement("option");
                        option.value = j + (i === 3 ? " dias" : "");
                        option.text = j + (i === 3 ? " dias" : "");
                        select.appendChild(option);
                    }
                    newCell.appendChild(select);
                } else {
                    var input = document.createElement("input");
                    input.type = "text";
                    newCell.appendChild(input);
                }
            });
            var actionCell = row.insertCell(cells.length);
            var removeButton = document.createElement("button");
            removeButton.type = "button";
            removeButton.innerText = "Remover";
            removeButton.onclick = function() { removeRow(this); };
            actionCell.appendChild(removeButton);
        }

        function removeRow(button) {
            var row = button.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }

        function generateExcel() {
            var data = [];
            var rows = document.querySelectorAll('table#dataTable tbody tr');

            rows.forEach((row) => {
                var cells = row.querySelectorAll('td input, td select');
                var rowData = [
                    cells[0].value,
                    cells[1].value,
                    cells[2].value,
                    cells[3].value
                ];
                data.push(rowData);
            });

            var ws_data = [["Código", "Arroz P1", "Arroz P2", "Prazo"]].concat(data);

            var wb = XLSX.utils.book_new();
            var ws = XLSX.utils.aoa_to_sheet(ws_data);

            // Define estilos de borda
            var borderAll = {
                top: { style: "thin" },
                bottom: { style: "thin" },
                left: { style: "thin" },
                right: { style: "thin" }
            };

            // Aplica as bordas a todas as células
            for (let R = 0; R < ws_data.length; R++) {
                for (let C = 0; C < ws_data[R].length; C++) {
                    let cell_address = XLSX.utils.encode_cell({r: R, c: C});
                    if (!ws[cell_address]) ws[cell_address] = { t: 's', v: ws_data[R][C] };
                    ws[cell_address].s = {
                        border: borderAll
                    };
                }
            }

            XLSX.utils.book_append_sheet(wb, ws, "Dados");
            XLSX.writeFile(wb, "dados.xlsx");
        }
    </script>
</body>
</html>













<!-- Preciso criar um script em HTML para gerar um resultado no Excel separando os dados informados pelo usuário em 2 colunas e 4 linhas, em casa linha terá essas informações: codigo, arroz p1, arroz P2 e prazo



Criei um arquivo html e colei esse codigo e salvei, quando fui testar, informei os dados e quando cliquei em gerar excel ele não criou um arquivo para download -->


