<!DOCTYPE html>
<html>

<head>
    <title>REALIZAR PEDIDOS</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>

<body>
    <table>
        <tr>
            <th>Codigo</th>
            <td>
                <input type="text" id="codigo" placeholder="Digite o código">
                <button onclick="buscarNome()">Buscar</button>
            </td>
        </tr>
        <tr>
            <th>Nome:</th>
            <td><span id="resultadoNome"></span>
            </td>
            </th>
        </tr>
        <tr>
            <th>Panela T1 5KG:</th>
            <td>
                <input type="text" id="panela1" placeholder="Qtd Arroz Panela T1 5KG">
            <th>Valor:<input type="text" id="vpanela1" placeholder="Valor Arroz Panela T1 5KG"></th>
            </td>
        </tr>
        <tr>
            <th>Panela T2 5KG:</th>
            <td>
                <input type="text" id="panela2" placeholder="Qtd Arroz Panela T2 5KG">
            <th>Valor:<input type="text" id="vpanela2" placeholder="Valor Arroz Panela T2 5KG"></th>
            </td>
        </tr>
        <tr>
            <th>Panela 1KG:</th>
            <td>
                <input type="text" id="panela1kg" placeholder="Qtd Arroz Panela 1KG">
            <th>Valor:<input type="text" id="vpanela1kg" placeholder="Valor Arroz Panela 1KG"></th>
            </td>
        </tr>
        <tr>
            <th>Reserva Esp:</th>
            <td>
                <input type="text" id="reserva" placeholder="Qtd Arroz Reserva Esp">
            <th>Valor:<input type="text" id="vreserva" placeholder="Valor Arroz Reserva Esp"></th>
            </td>
        </tr>
        <tr>
            <th>Komabem:</th>
            <td>
                <input type="text" id="komabem" placeholder="Qtd Arroz Komabem">
            <th>Valor:<input type="text" id="vkomabem" placeholder="Valor Arroz Komabem"></th>
            </td>
        </tr>
        <tr>
            <th>Komabem 2KG:</th>
            <td>
                <input type="text" id="komabem2kg" placeholder="Qtd Arroz Komabem 2KG">
            <th>Valor:<input type="text" id="vkomabem2kg" placeholder="Valor Arroz Komabem 2KG"></th>
            </td>
        </tr>
        </tr>
        <tr>
            <th>Fogao T1 5KG:</th>
            <td>
                <input type="text" id="fogao1" placeholder="Qtd Arroz Fogao T1 5KG">
            <th>Valor:<input type="text" id="vfogao1" placeholder="Valor Arroz Fogao T1 5KG"></th>
            </td>
        </tr>
        <tr>
            <th>Fogao T2 5KG:</th>
            <td>
                <input type="text" id="fogao2" placeholder="Qtd Arroz Fogao T2 5KG">
            <th>Valor:<input type="text" id="vfogao2" placeholder="Valor Arroz Fogao T2 5KG"></th>
            </td>
        </tr>
        <tr>
            <th>Vo Pedro 5KG:</th>
            <td>
                <input type="text" id="vopedro" placeholder="Qtd Arroz Vo Pedro">
            <th>Valor:<input type="text" id="vvopedro" placeholder="Valor Arroz Vo Pedro"></th>
            </td>
        </tr>
        <tr>
            <th>Integral 1KG:</th>
            <td>
                <input type="text" id="integral1kg" placeholder="Qtd Arroz Integral 1KG">
            <th>Valor:<input type="text" id="vintegral1kg" placeholder="Valor Arroz Integral 1KG"></th>
            </td>
        </tr>
        <tr>
            <th>Parbolizado 5KG:</th>
            <td>
                <input type="text" id="parbolizado" placeholder="Qtd Arroz Parbolizado">
            <th>Valor:<input type="text" id="vparbolizado" placeholder="Valor Arroz Parbolizado"></th>
            </td>
        </tr>
    </table>

    <button onclick="adicionarDados()">Adicionar</button>
    <button onclick="gerarExcel()">Gerar Excel</button>
    <button onclick="limparTabela()">Limpar</button>
    <p><label> PEDIDOS</label></p>
    <table id="resultado">
        <thead>
            <tr>
                <th>Código</th>
                <th>Cliente</th>
                <th>Panela T1 5KG</th>
                <th>Valor Panela T1 5KG</th>
                <th>Panela T2 5KG</th>
                <th>Valor Panela T2 5KG</th>
                <th>Panela 1KG</th>
                <th>Valor Panela 1KG</th>
                <th>Reserva Esp</th>
                <th>Valor Reserva Esp</th>
                <th>Komabem</th>
                <th>Valor Komabem</th>
                <th>Komabem 2KG</th>
                <th>Valor Komabem 2KG</th>
                <th>Fogao T1 5KG</th>
                <th>Valor Fogao T1 5KG</th>
                <th>Fogao T2 5KG</th>
                <th>Valor Fogao T2 5KG</th>
                <th>Vo Pedro 5KG</th>
                <th>Valor Vo Pedro 5KG</th>
                <th>Integral 1KG</th>
                <th>Valor Integrak 1KG</th>
                <th>Parbolizado 5KG</th>
                <th>Valor Parbolizado 5KG</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <script>
        function buscarNome() {
            const codigoInput = document.getElementById('codigo');
            const resultado = document.getElementById('resultadoNome');
            const codigoBuscado = codigoInput.value;

            // Assumindo que o arquivo JSON está no mesmo diretório e tem o nome "codigos.json"
            fetch('codigos.json')
                .then(response => response.json())
                .then(data => {
                    const codigoEncontrado = data.find(item => item.codigo === codigoBuscado);
                    if (codigoEncontrado) {
                        resultado.textContent = codigoEncontrado.nome;
                    } else {
                        resultado.textContent = "Código não encontrado.";
                    }
                })
                .catch(error => {
                    console.error('Erro ao buscar dados:', error);
                    resultado.textContent = "Erro ao buscar o código.";
                });
        }

        let dados = [];

        fetch('codigos.json')
            .then(response => response.json())
            .then(data => {
                dados = data;
                // Chamar a função adicionarDados após os dados serem carregados
                adicionarDados();
            })
            .catch(error => {
                console.error('Erro ao carregar os dados:', error);
            });

        function adicionarDados() {
            const codigo = document.getElementById('codigo').value;
            const panela1 = document.getElementById('panela1').value;
            const vpanela1 = document.getElementById('vpanela1').value;
            const panela2 = document.getElementById('panela2').value;
            const vpanela2 = document.getElementById('vpanela2').value;
            const panela1kg = document.getElementById('panela1kg').value;
            const vpanela1kg = document.getElementById('vpanela1kg').value;
            const reserva = document.getElementById('reserva').value;
            const vreserva = document.getElementById('vreserva').value;
            const komabem = document.getElementById('komabem').value;
            const vkomabem = document.getElementById('vkomabem').value;
            const komabem2kg = document.getElementById('komabem2kg').value;
            const vkomabem2kg = document.getElementById('vkomabem2kg').value;
            const fogao1 = document.getElementById('fogao1').value;
            const vfogao1 = document.getElementById('vfogao1').value;
            const fogao2 = document.getElementById('fogao2').value;
            const vfogao2 = document.getElementById('vfogao2').value;
            const vopedro = document.getElementById('vopedro').value;
            const vvopedro = document.getElementById('vvopedro').value;
            const integral1kg = document.getElementById('integral1kg').value;
            const vintegral1kg = document.getElementById('vintegral1kg').value;
            const parbolizado = document.getElementById('parbolizado').value;
            const vparbolizado = document.getElementById('vparbolizado').value;

            const resultado = dados.find(item => item.codigo === codigo);

            const tabelaBody = document.getElementById('resultado').getElementsByTagName('tbody')[0];

            if (resultado) {
                const novaLinha = tabelaBody.insertRow();
                const celulaCodigo = novaLinha.insertCell();
                const celulaNome = novaLinha.insertCell();
                const celulaPanela1 = novaLinha.insertCell();
                const celulaVPanela1 = novaLinha.insertCell();
                const celulaPanela2 = novaLinha.insertCell();
                const celulaVPanela2 = novaLinha.insertCell();
                const celulaPanela1kg = novaLinha.insertCell();
                const celulaVPanela1kg = novaLinha.insertCell();
                const celulaReserva = novaLinha.insertCell();
                const celulaVReserva = novaLinha.insertCell();
                const celulaKomabem = novaLinha.insertCell();
                const celulaVKomabem = novaLinha.insertCell();
                const celulaKomabem2kg = novaLinha.insertCell();
                const celulaVKomabem2kg = novaLinha.insertCell();
                const celulafogao1 = novaLinha.insertCell();
                const celulaVfogao1 = novaLinha.insertCell();
                const celulafogao2 = novaLinha.insertCell();
                const celulaVfogao2 = novaLinha.insertCell();
                const celulavopedro = novaLinha.insertCell();
                const celulaVVopedro = novaLinha.insertCell();
                const celulaintegral1kg = novaLinha.insertCell();
                const celulaVintegral1kg = novaLinha.insertCell();
                const celulaparbolizado = novaLinha.insertCell();
                const celulaVparbolizado = novaLinha.insertCell();
                celulaCodigo.textContent = resultado.codigo;
                celulaNome.textContent = resultado.nome;
                celulaPanela1.textContent = panela1;
                celulaVPanela1.textContent = vpanela1;
                celulaPanela2.textContent = panela2;
                celulaVPanela2.textContent = vpanela2;
                celulaPanela1kg.textContent = panela1kg;
                celulaVPanela1kg.textContent = vpanela1kg;
                celulaReserva.textContent = reserva;
                celulaVReserva.textContent = vreserva;
                celulaKomabem.textContent = komabem;
                celulaVKomabem.textContent = vkomabem;
                celulaKomabem2kg.textContent = komabem2kg;
                celulaVKomabem2kg.textContent = vkomabem2kg;
                celulafogao1.textContent = fogao1;
                celulaVfogao1.textContent = vfogao1;
                celulafogao2.textContent = fogao2;
                celulaVfogao2.textContent = vfogao2;
                celulavopedro.textContent = vopedro;
                celulaVVopedro.textContent = vvopedro;
                celulaintegral1kg.textContent = integral1kg;
                celulaVintegral1kg.textContent = vintegral1kg;
                celulaparbolizado.textContent = parbolizado;
                celulaVparbolizado.textContent = vparbolizado;
            } 
        }

        function limparTabela() {
            const tabelaBody = document.getElementById('resultado').getElementsByTagName('tbody')[0];
            while (tabelaBody.firstChild) {
                tabelaBody.removeChild(tabelaBody.firstChild);
            }
        }

        function gerarExcel() {
            // Obtém os dados da tabela
            const tabela = document.getElementById('resultado');
            const linhas = tabela.getElementsByTagName('tr');

            // Cria um novo workbook e worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.table_to_sheet(tabela);

            // Adiciona a worksheet ao workbook
            XLSX.utils.book_append_sheet(wb, ws, 'Resultados');

            // Cria o arquivo Excel
            XLSX.writeFile(wb, 'resultados.xlsx');
        }

    </script>
</body>

</html>